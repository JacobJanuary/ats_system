# ‚úÖ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ fas.scoring_history

## üìä –°–¢–ê–¢–£–°: –ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï

–°–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ —Å —É—Å—Ç–∞—Ä–µ–≤—à–µ–π —Ç–∞–±–ª–∏—Ü—ã `smart_ml.predictions` –Ω–∞ –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–∏–≥–Ω–∞–ª–æ–≤ `fas.scoring_history`.

## ‚úÖ –ß–¢–û –ë–´–õ–û –°–î–ï–õ–ê–ù–û

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- ‚úÖ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∫–ª–∞—Å—Å `TradingSignalV2` –≤ `database/models_v2.py`
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `SignalRepositoryV2` –≤ `database/signal_repository_v2.py`
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `DatabaseManager` –≤ `database/connection.py`

### 2. –û–±–Ω–æ–≤–ª–µ–Ω main.py
```python
# –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∏ USE_SCORING_HISTORY=true
if self.db.use_new_signal_source:
    signals = await self.db.signals_v2.get_unprocessed_signals_legacy(limit=10)
else:
    signals = await self.db.signals.get_unprocessed_signals(limit=10)
```

### 3. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ `ats.signals`:
- `total_score` - –æ–±—â–∏–π —Å—á–µ—Ç —Å–∏–≥–Ω–∞–ª–∞
- `score_week` - –Ω–µ–¥–µ–ª—å–Ω—ã–π —Å—á–µ—Ç
- `score_month` - –º–µ—Å—è—á–Ω—ã–π —Å—á–µ—Ç  
- `recommended_action` - —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è .env
```env
USE_SCORING_HISTORY=true     # –í–∫–ª—é—á–µ–Ω –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
MIN_SCORE_WEEK=59            # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–µ–¥–µ–ª—å–Ω—ã–π —Å—á–µ—Ç
MIN_SCORE_MONTH=59           # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –º–µ—Å—è—á–Ω—ã–π —Å—á–µ—Ç
```

## üìà –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ú–ò–ì–†–ê–¶–ò–ò

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –°–∏–≥–Ω–∞–ª–æ–≤ –≤ —Å—Ç–∞—Ä–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ (–∑–∞ —á–∞—Å) | 0 |
| –°–∏–≥–Ω–∞–ª–æ–≤ –≤ –Ω–æ–≤–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ (–∑–∞ —á–∞—Å) | 739 |
| –°—Ä–µ–¥–Ω–∏–π –Ω–µ–¥–µ–ª—å–Ω—ã–π score | 48.05 |
| –°—Ä–µ–¥–Ω–∏–π –º–µ—Å—è—á–Ω—ã–π score | 45.79 |
| –ú–∞–∫—Å –Ω–µ–¥–µ–ª—å–Ω—ã–π score | 100.00 |
| –ú–∞–∫—Å –º–µ—Å—è—á–Ω—ã–π score | 85.70 |

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ì–û –ò–°–¢–û–ß–ù–ò–ö–ê

### 1. –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è JOIN —Å predictions
- –ë—ã—Å—Ç—Ä–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–µ–Ω—å—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### 2. –ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –î–µ—Ç–∞–ª—å–Ω—ã–µ scores (pattern, indicator, combination)
- –ù–µ–¥–µ–ª—å–Ω—ã–µ –∏ –º–µ—Å—è—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π (BUY/SELL/NO_TRADE)

### 3. –ì–∏–±–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –ü–æ –Ω–µ–¥–µ–ª—å–Ω—ã–º/–º–µ—Å—è—á–Ω—ã–º scores
- –ü–æ —Ç–∏–ø—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –ü–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
- MIN_SCORE_WEEK=59 –∏ MIN_SCORE_MONTH=59 –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—Å–æ–∫–∏–º–∏
- –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è: –Ω–µ–¥–µ–ª—è 48.05, –º–µ—Å—è—Ü 45.79
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- –í—Å–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `signal_id` –≤ —Ç–∞–±–ª–∏—Ü–µ `ats.signals`
- –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω—É–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏

## üìã –ß–ï–ö–õ–ò–°–¢ –î–õ–Ø –ó–ê–ü–£–°–ö–ê

- [x] USE_SCORING_HISTORY=true –≤ .env
- [x] MIN_SCORE_WEEK –∏ MIN_SCORE_MONTH –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏)
- [x] main.py –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- [x] signal_processor.py —Å–æ–≤–º–µ—Å—Ç–∏–º
- [x] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

## üöÄ –ö–û–ú–ê–ù–î–´

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
python verify_migration.py
```

### –¢–µ—Å—Ç –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
```bash
python test_new_signal_source.py
```

### –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
python main.py
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
tail -f ats_system.log | grep "scoring_history"
```

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ü–û–°–õ–ï –ó–ê–ü–£–°–ö–ê

–°–ª–µ–¥–∏—Ç–µ –∑–∞:
1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ª—É—á–∞–µ–º—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
2. –ö–∞—á–µ—Å—Ç–≤–æ–º —Å–∏–≥–Ω–∞–ª–æ–≤ (–ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö)
3. –°–∫–æ—Ä–æ—Å—Ç—å—é –æ–±—Ä–∞–±–æ—Ç–∫–∏
4. –û—à–∏–±–∫–∞–º–∏ –≤ –ª–æ–≥–∞—Ö

## üîÑ –û–¢–ö–ê–¢ (–µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è)

–î–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ —Å—Ç–∞—Ä—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `USE_SCORING_HISTORY=false` –≤ .env
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
3. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –Ω–∞ `smart_ml.predictions`

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!**

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ —Å –Ω–æ–≤—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Å–∏–≥–Ω–∞–ª–æ–≤ `fas.scoring_history`. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã. 

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ testnet –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–µ —á–∞—Å—ã —Ä–∞–±–æ—Ç—ã
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ production!** üéâ