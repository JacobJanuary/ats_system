{"timestamp": "2025-09-07T22:39:27.698672+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 1, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:41:27.725626+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 2, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:43:27.740112+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 3, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:45:27.756075+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 4, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:47:27.775735+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 5, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:49:27.789757+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 6, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:51:27.807558+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 7, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:53:27.826985+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 8, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:55:27.846532+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 9, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:57:27.864008+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 10, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T22:59:27.879893+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 11, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:01:27.899940+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 12, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:03:27.919166+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 13, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:05:27.936333+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 14, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:07:27.958551+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 15, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:09:27.980212+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 16, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:11:27.999193+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 17, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:13:28.016446+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 18, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:15:28.034923+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 19, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:17:28.058048+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 20, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:19:28.079493+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 21, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:21:28.098043+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 22, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:23:28.119474+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 23, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:25:28.144493+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 24, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:27:28.169509+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 25, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:29:28.192195+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 26, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:31:28.214338+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 27, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:33:28.237763+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 28, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:35:28.257988+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 29, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:37:28.277204+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 30, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:39:28.295341+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 31, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:41:28.321021+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 32, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:43:28.342143+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 33, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:45:28.363278+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 34, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:47:28.389445+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 35, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:49:28.407609+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 36, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:51:28.431680+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 37, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:53:28.455467+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 38, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:55:28.479902+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 39, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:57:28.503587+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 40, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-07T23:59:28.528716+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 41, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:01:28.552612+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 42, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:03:28.573893+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 43, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:05:28.585818+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 44, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:07:28.605341+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 45, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:09:28.631221+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 46, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:11:28.652203+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 47, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:13:28.674569+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 48, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:15:28.699378+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 49, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:17:28.720216+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 50, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:19:28.735984+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 51, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:21:28.759907+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 52, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:23:28.781048+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 53, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:25:28.804525+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 54, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:26:32.841154+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 55, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:27:36.876183+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 56, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:28:40.912302+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 57, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:29:44.970582+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 58, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:30:49.006730+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 59, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:31:56.036914+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 60, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:33:00.069479+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 61, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:35:00.088420+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 62, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:36:04.128037+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 63, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:37:39.170280+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 64, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:38:43.204688+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 65, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:40:43.225630+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 66, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:42:43.236241+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 67, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:44:43.260584+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 68, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T00:45:43.288134+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 69, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:46:45.373458+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 70, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:47:45.396097+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 71, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:48:46.424440+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 72, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:49:46.445890+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 73, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:50:47.474909+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 74, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:51:47.497503+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 75, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:52:49.524352+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 76, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:53:50.553597+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 77, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:54:55.577723+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 78, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:55:55.597944+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 79, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:56:55.648894+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 80, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:57:56.680049+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 81, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:58:58.700639+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 82, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T00:59:58.720201+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 83, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:00:58.742640+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 84, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:01:58.840592+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 85, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:02:58.860061+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 86, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:03:59.883450+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 87, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:04:59.905154+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 88, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:06:59.921223+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 89, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:07:59.943190+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 90, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:09:00.965093+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 91, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:10:00.986538+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 92, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:11:02.007144+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 93, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:12:02.035695+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 94, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:13:03.060575+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 95, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:14:03.084074+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 96, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:16:03.102606+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 97, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:17:06.165036+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 98, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:18:06.195921+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 99, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:19:06.218880+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 100, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:20:06.241180+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 101, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:21:06.258395+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 102, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:22:06.283748+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 103, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:23:06.304593+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 104, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:24:06.330669+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 105, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:25:06.354631+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 106, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:26:07.377414+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 107, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:27:07.398223+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 108, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:28:07.418932+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 109, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:29:07.436156+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 110, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:30:07.462718+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 111, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:31:08.488280+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 112, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:32:09.524226+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 113, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:33:14.552023+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 114, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:35:14.575823+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 115, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:37:14.597175+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 116, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:39:14.617085+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 117, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:41:14.638469+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 118, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T01:42:14.693186+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 119, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:43:14.714172+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 120, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:44:14.738194+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 121, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:45:14.763695+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 122, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:46:14.795320+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 123, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:47:14.819171+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 124, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:48:14.842971+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 125, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:49:14.857433+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 126, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:50:21.886063+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 127, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:51:22.917459+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 128, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:52:24.946256+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 129, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:53:24.977469+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 130, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:54:25.001848+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 131, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:55:27.027701+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 132, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:56:28.083539+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 133, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T01:58:28.108327+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 134, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:00:28.131749+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 135, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:02:03.173696+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 136, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:03:03.200634+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 137, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:04:03.223149+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 138, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:05:05.230121+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 139, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:06:07.264704+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 140, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:07:07.290182+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 141, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:08:10.319994+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 142, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:09:10.375676+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 143, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:10:10.400060+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 144, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:11:10.422790+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 145, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:12:10.444266+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 146, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:13:13.472717+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 147, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:14:15.497817+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 148, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:15:17.527981+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 149, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:16:18.579523+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 150, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:17:21.606448+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 151, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:18:22.634434+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 152, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:19:23.656209+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 153, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:21:23.676057+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 154, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:23:23.711496+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 155, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:24:42.749874+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 156, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:25:42.766531+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 157, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:26:42.788270+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 158, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:27:42.804879+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 159, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:28:42.825030+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 160, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:29:42.848313+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 161, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:30:42.871764+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 162, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:31:42.906327+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 163, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:32:42.930909+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 164, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:33:42.951090+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 165, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:34:42.975892+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 166, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:35:43.995063+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 167, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:36:48.039714+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 168, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:37:50.068768+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 169, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:38:50.099642+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 170, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:39:53.129333+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 171, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:41:53.149286+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 172, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:43:53.173093+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 173, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:45:53.194832+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 174, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:47:53.216387+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 175, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T02:48:53.239154+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 176, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:49:53.260290+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 177, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:50:53.283911+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 178, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:51:53.304480+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 179, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:52:53.329728+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 180, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:53:53.351968+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 181, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:54:53.376961+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 182, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:55:53.397953+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 183, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:56:53.419942+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 184, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:57:56.443474+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 185, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T02:59:56.462626+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 186, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T03:01:15.498594+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 187, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:02:20.534728+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 188, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:03:20.564845+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 189, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:04:20.587640+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 190, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:05:20.616677+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 191, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:06:55.663745+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 192, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:07:55.692954+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 193, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:08:56.718513+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 194, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:09:56.753872+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 195, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:10:56.744217+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 196, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:11:57.759843+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 197, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:12:57.784374+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 198, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:13:57.810630+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 199, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:14:57.834714+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 200, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:15:57.855419+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 201, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:16:57.875913+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 202, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:17:57.899466+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 203, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:18:57.925286+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 204, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:19:57.971191+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 205, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:20:57.989902+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 206, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:21:58.012283+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 207, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:22:58.025211+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 208, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:23:58.042052+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 209, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:25:02.069524+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 210, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:26:04.098745+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 211, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:27:04.153385+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 212, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:28:07.191008+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 213, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:29:18.227678+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 214, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:31:18.254307+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 215, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T03:32:23.291425+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 216, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:33:23.316047+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 217, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:34:23.331572+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 218, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:35:23.368386+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 219, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:36:23.403831+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 220, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:37:23.426277+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 221, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:38:23.442755+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 222, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:39:23.461425+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 223, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:40:23.482240+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 224, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:41:25.503882+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 225, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:42:26.528068+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 226, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:43:26.554756+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 227, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:44:26.601244+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 228, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:45:26.625653+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 229, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:46:30.661001+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 230, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:48:30.684721+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 231, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T03:50:30.706902+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 232, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T03:52:30.727436+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 233, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T03:53:30.777529+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 234, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:54:30.829958+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 235, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:55:30.854534+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 236, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:56:30.877477+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 237, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:57:30.922660+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 238, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:58:30.949049+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 239, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T03:59:30.976859+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 240, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:00:31.003935+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 241, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:01:31.046426+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 242, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:02:31.079077+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 243, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:03:34.184634+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 244, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:04:35.216840+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 245, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:05:40.249228+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 246, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:06:40.272363+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 247, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:07:40.296671+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 248, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:08:43.349211+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 249, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:10:43.371490+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 250, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:12:43.388669+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 251, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:13:54.420062+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 252, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:14:58.451118+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 253, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:16:58.472061+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 254, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:18:58.491500+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 255, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:19:58.545025+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 256, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:20:58.563145+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 257, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:21:58.606546+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 258, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:22:58.628944+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 259, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:23:58.650028+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 260, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:24:58.675273+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 261, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:25:58.704987+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 262, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:26:58.729672+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 263, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:27:59.751751+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 264, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:28:59.782894+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 265, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:29:59.802970+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 266, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:31:01.828379+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 267, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:32:01.854809+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 268, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:34:01.877382+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 269, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:36:01.873978+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 270, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:38:01.894701+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 271, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:40:01.916865+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 272, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:42:01.935454+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 273, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:43:01.955663+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 274, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:44:01.977486+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 275, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:45:02.002013+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 276, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:46:02.029847+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 277, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:47:02.055121+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 278, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:48:02.076094+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 279, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:49:02.100339+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 280, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:50:02.137854+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 281, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:51:02.158280+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 282, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:52:02.184537+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 283, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:53:03.219710+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 284, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:54:06.248646+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 285, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:55:06.276778+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 286, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T04:57:06.300472+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 287, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T04:59:06.324946+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 288, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:01:06.349385+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 289, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:02:06.376439+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 290, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:03:08.431209+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 291, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:04:09.454025+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 292, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:05:09.473965+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 293, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:06:09.502198+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 294, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:07:09.527145+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 295, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:08:09.557833+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 296, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:09:09.578948+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 297, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:10:16.616824+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 298, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:11:17.657776+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 299, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:12:17.683243+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 300, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:13:18.706024+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 301, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:14:19.738086+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 302, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:15:19.763813+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 303, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:16:19.786387+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 304, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:17:19.815197+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 305, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:19:19.836851+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 306, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:21:19.858785+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 307, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:23:19.883933+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 308, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:24:54.927950+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 309, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:25:54.966297+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 310, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:26:54.987086+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 311, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:27:55.013110+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 312, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:28:55.043979+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 313, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:29:55.077002+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 314, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:30:55.100192+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 315, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:31:55.121317+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 316, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:32:55.151778+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 317, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:33:55.183103+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 318, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:34:55.207913+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 319, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:35:55.226510+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 320, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:37:06.263013+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 321, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:39:06.282922+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 322, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:40:06.309982+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 323, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:41:41.348669+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 324, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:42:41.372307+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 325, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:43:41.403537+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 326, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:45:41.423953+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 327, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T05:46:43.503966+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 328, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:47:43.530962+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 329, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:48:43.570673+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 330, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:49:43.597753+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 331, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:50:43.615899+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 332, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:51:43.640771+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 333, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:52:43.666349+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 334, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:53:43.701806+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 335, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:54:45.724678+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 336, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:55:45.766029+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 337, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:56:45.789821+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 338, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:57:45.811991+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 339, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T05:59:45.834132+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 340, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:01:20.885456+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 341, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:03:20.904001+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 342, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:05:20.929649+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 343, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:06:21.952497+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 344, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:07:21.991053+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 345, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:08:22.013807+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 346, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:09:22.041748+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 347, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:10:22.067205+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 348, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:11:22.094157+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 349, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:12:23.116687+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 350, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:13:25.149260+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 351, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:14:30.194996+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 352, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:15:49.233219+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 353, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:16:49.259783+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 354, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:17:49.298125+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 355, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:18:49.328125+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 356, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:19:49.356359+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 357, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:20:49.379030+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 358, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:21:49.395510+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 359, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:22:49.417895+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 360, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:24:49.438102+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 361, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:26:49.457706+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 362, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:28:49.480160+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 363, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:29:49.501499+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 364, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:30:49.529685+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 365, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:31:51.560136+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 366, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:32:51.605811+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 367, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:33:51.632280+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 368, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:34:51.660183+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 369, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:35:51.680186+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 370, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:36:51.702732+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 371, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:37:51.705727+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 372, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:39:02.816187+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 373, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:41:02.833076+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 374, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:43:02.854857+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 375, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T06:44:07.886154+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 376, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:45:07.906227+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 377, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:46:07.931262+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 378, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:47:07.951826+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 379, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:48:07.974799+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 380, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:49:09.998199+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 381, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:50:11.028975+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 382, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:51:11.053920+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 383, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:52:13.080176+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 384, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:53:32.113032+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 385, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:54:39.144896+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 386, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:55:46.175787+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 387, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:56:46.213589+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 388, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:57:46.238563+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 389, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:58:46.263805+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 390, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T06:59:46.290615+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 391, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:00:46.313721+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 392, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:01:46.335041+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 393, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:02:46.359890+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 394, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:04:05.483421+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 395, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:05:09.551350+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 396, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:07:09.562255+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 397, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:09:09.577767+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 398, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:10:11.599936+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 399, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:11:11.627420+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 400, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:12:12.617783+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 401, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:13:14.639858+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 402, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:14:14.670997+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 403, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:15:14.690950+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 404, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:16:14.722789+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 405, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:17:17.814933+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 406, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:18:17.838763+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 407, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:19:20.869933+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 408, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:20:23.901254+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 409, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:22:23.920366+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 410, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:24:23.939215+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 411, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:25:23.976193+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 412, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:26:23.999804+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 413, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:27:24.023314+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 414, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:28:24.039232+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 415, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:29:24.056102+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 416, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:30:31.093822+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 417, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:31:33.141683+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 418, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:32:35.171119+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 419, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:33:35.200338+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 420, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:34:39.252864+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 421, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:35:39.278202+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 422, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:36:39.300412+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 423, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:37:42.356896+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 424, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:38:42.378119+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 425, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:39:43.403108+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 426, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:40:43.423896+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 427, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:41:43.453910+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 428, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:42:44.478838+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 429, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:43:45.502752+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 430, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:45:45.526289+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 431, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:46:45.551280+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 432, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:47:45.577643+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 433, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:48:45.602293+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 434, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:49:45.625229+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 435, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:50:45.639976+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 436, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:52:45.651395+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 437, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T07:53:45.674525+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 438, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:54:46.696466+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 439, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:55:46.739017+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 440, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:56:46.763510+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 441, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:57:46.786281+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 442, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:58:46.811043+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 443, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T07:59:46.846884+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 444, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:00:49.868959+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 445, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:01:49.892590+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 446, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:02:53.924139+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 447, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:03:53.945579+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 448, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:04:53.947089+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 449, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:05:53.970977+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 450, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:06:54.992050+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 451, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:07:57.022843+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 452, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:08:57.046511+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 453, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:10:57.066901+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 454, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:11:58.093406+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 455, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:12:58.120861+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 456, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:13:58.147788+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 457, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:15:58.166793+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 458, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:16:58.190077+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 459, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:17:58.214109+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 460, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:18:58.237409+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 461, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:19:58.289813+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 462, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:20:58.313959+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 463, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:21:58.335282+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 464, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:22:58.363044+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 465, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:23:58.383319+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 466, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:25:01.416088+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 467, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:26:02.438386+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 468, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:27:02.460179+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 469, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:29:02.475646+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 470, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:31:02.491465+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 471, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:32:13.516992+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 472, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:33:13.540770+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 473, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:34:13.567202+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 474, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:35:15.629856+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 475, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:36:15.659141+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 476, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:37:17.686722+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 477, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:38:17.713062+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 478, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:40:17.733597+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 479, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:42:17.751405+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 480, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:43:52.787437+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 481, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:44:52.806598+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 482, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:45:52.829695+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 483, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:46:52.857073+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 484, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:47:55.889618+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 485, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:48:55.917120+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 486, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:50:55.929747+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 487, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:52:55.951275+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 488, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T08:53:56.994965+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 489, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:54:57.048937+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 490, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:55:57.070760+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 491, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:56:57.132522+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 492, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:57:57.154783+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 493, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:58:57.175200+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 494, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T08:59:57.222034+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 495, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:00:57.245554+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 496, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:01:57.305405+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 497, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:03:57.322962+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 498, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T09:04:58.344144+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 499, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:05:58.367170+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 500, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:06:58.403306+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 501, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:08:01.427076+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 502, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:09:01.458232+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 503, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:10:01.486657+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 504, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:11:01.506436+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 505, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:12:01.526371+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 506, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:13:01.716454+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 507, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:14:01.738985+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 508, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:15:01.761179+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 509, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:16:01.788140+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 510, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:17:01.809649+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 511, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:18:03.835310+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 512, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:19:04.858380+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 513, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:21:04.875299+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 514, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T09:22:23.909641+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 515, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:24:23.931464+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 516, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T09:25:23.955672+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 517, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:26:23.978690+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 518, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:27:23.965570+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 519, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:28:23.988528+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 520, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:29:24.006985+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 521, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:30:25.036660+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 522, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:31:25.060888+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 523, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:32:30.104988+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 524, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:33:34.143689+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 525, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:34:38.173728+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 526, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:35:41.200625+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 527, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:36:45.233455+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 528, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:38:45.251524+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 529, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T09:39:46.276623+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 530, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:40:46.304213+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 531, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:41:46.352239+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 532, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:42:46.375299+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 533, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:43:46.415058+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 534, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:45:46.440576+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 535, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T09:46:46.469105+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 536, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:47:46.502596+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 537, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:48:46.524195+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 538, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:49:46.576576+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 539, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:50:46.598994+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 540, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:51:46.619992+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 541, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:52:46.647350+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 542, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:53:51.706675+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 543, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:54:51.937083+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 544, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Network is unreachable", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 659, in _sock_connect\n    sock.connect(address)\n"]}}
{"timestamp": "2025-09-08T09:55:51.956227+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 545, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Network is unreachable", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 659, in _sock_connect\n    sock.connect(address)\n"]}}
{"timestamp": "2025-09-08T09:56:51.980653+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 546, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:57:53.007041+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 547, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:58:54.031043+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 548, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T09:59:54.060922+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 549, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:00:57.089939+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 550, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:01:59.113884+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 551, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:02:59.135947+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 552, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:04:06.164526+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 553, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:05:10.192399+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 554, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:06:10.217349+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 555, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:07:10.237560+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 556, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:08:14.295839+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 557, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:09:14.311980+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 558, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Network is unreachable", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 659, in _sock_connect\n    sock.connect(address)\n"]}}
{"timestamp": "2025-09-08T10:10:14.329097+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 559, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Network is unreachable", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 659, in _sock_connect\n    sock.connect(address)\n"]}}
{"timestamp": "2025-09-08T10:11:14.341366+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 560, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "OSError", "message": "[Errno 51] Network is unreachable", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 659, in _sock_connect\n    sock.connect(address)\n"]}}
{"timestamp": "2025-09-08T10:12:25.367725+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 561, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:13:25.391603+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 562, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:15:25.408768+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 563, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "TimeoutError", "message": "", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2420, in connect\n    if entry is None:\n           ^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/timeouts.py\", line 115, in __aexit__\n    raise TimeoutError from exc_val\n"]}}
{"timestamp": "2025-09-08T10:16:25.430848+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 564, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:17:26.452694+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 565, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:18:26.478811+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 566, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:19:27.501682+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 567, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:20:32.530933+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 568, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:21:33.555291+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 569, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:22:38.580660+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 570, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:23:40.601796+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 571, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
{"timestamp": "2025-09-08T10:24:43.628538+00:00", "level": "ERROR", "message": "Cleanup task error", "context": {"task": "cleanup"}, "metrics": {"errors": 572, "warnings": 0, "critical": 0, "orphan_positions": 0, "ghost_positions": 0, "failed_orders": 0, "successful_orders": 0, "reconciliation_errors": 0}, "exception": {"type": "ConnectionRefusedError", "message": "[Errno 61] Connect call failed ('10.8.0.1', 5432)", "traceback": ["  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/main.py\", line 440, in cleanup_task\n    async def shutdown(self):\n                ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 757, in update_daily_metrics\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 71, in execute\n    async with self.acquire() as conn:\n               ^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py\", line 210, in __aenter__\n    return await anext(self.gen)\n           ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/database/connection.py\", line 66, in acquire\n    async with self.pool.acquire() as connection:\n               ^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 1024, in __aenter__\n    CREATE TABLE names (\n           ^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 864, in _acquire\n    async def close(self):\n                   ^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 849, in _acquire_impl\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 140, in acquire\n    self._pool._loop.create_task(\n    ^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 132, in connect\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/pool.py\", line 517, in _get_new_connection\n    # when `acquire` is called again.\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connection.py\", line 2421, in connect\n    return\n       ^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1075, in _connect\n    def _create_future(loop):\n        ^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 1049, in _connect\n    _set_nodelay(_get_socket(tr))\n           ^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 886, in _connect_addr\n    params.sslmode == SSLMode.allow and not pr.is_ssl or\n       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 931, in __connect_addr\n    async def can_be_used(connection):\n             ^^^^^^^^^^^^^^^\n", "  File \"/Users/evgeniyyanvarskiy/PycharmProjects/ats_system/.venv/lib/python3.12/site-packages/asyncpg/connect_utils.py\", line 802, in _create_ssl_connection\n    connection_class,\n             ^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1121, in create_connection\n    raise exceptions[0]\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1103, in create_connection\n    sock = await self._connect_sock(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/base_events.py\", line 1006, in _connect_sock\n    await self.sock_connect(sock, address)\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 651, in sock_connect\n    return await fut\n           ^^^^^^^^^\n", "  File \"/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/selector_events.py\", line 691, in _sock_connect_cb\n    raise OSError(err, f'Connect call failed {address}')\n"]}}
